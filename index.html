<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCP Test Generator</title>
<style>
  body { font-family: Arial, sans-serif; background: #111; color: #eee; padding: 20px; }
  h1,h2 { color: #fff; }
  label { display: block; margin-top: 10px; font-weight: bold; }
  input, textarea, button { margin-top: 5px; padding: 8px; width: 100%; max-width: 600px; border: 1px solid #555; border-radius: 4px; background: #222; color: #eee; }
  button { cursor: pointer; margin-top: 10px; background: #333; border: 1px solid #888; }
  .output { margin-top: 20px; padding: 15px; border: 1px solid #444; border-radius: 6px; background: #1a1a1a; max-width: 800px; white-space: pre-wrap; }
  .line { margin: 10px 0; padding: 8px; background: #222; border-radius: 4px; display: flex; justify-content: space-between; align-items: center; }
  .line span { flex: 1; margin-right: 10px; }
  .copy-btn { background: #444; border: 1px solid #666; padding: 5px 10px; border-radius: 4px; cursor: pointer; color: #eee; }
  .section { border:1px solid #555; border-radius:6px; padding:10px; margin-top:15px; background:#1a1a1a; }
  .timeline-step { display:flex; margin-top:5px; }
  .timeline-step input { flex:1; margin-right:5px; }
</style>
</head>
<body>
<h1>SCP Test Generator</h1>

<!-- Basic Info -->
<div class="section">
<label for="host">Host</label>
<input type="text" id="host" placeholder="@YourName">

<label for="scp">SCP Number</label>
<input type="text" id="scp" placeholder="e.g., 096">

<label for="class">Classification</label>
<input type="text" id="class" placeholder="e.g., KETER">

<label for="goal">Testing Objective</label>
<textarea id="goal" placeholder="Clearly state the purpose and goals of the test"></textarea>

<label for="materials">Materials Used</label>
<textarea id="materials" placeholder="List equipment, tools, and resources utilized"></textarea>

<label for="observations">Observations & Results</label>
<textarea id="observations" placeholder="Detailed account of what was observed during testing"></textarea>

<label for="analysis">Analysis</label>
<textarea id="analysis" placeholder="Scientific interpretation of results and their significance"></textarea>

<label for="approved">Approved By</label>
<input type="text" id="approved" placeholder="@Approver">
</div>

<!-- Personnel -->
<div class="section">
<h2>Personnel</h2>
<label for="assistants">Assistant Researchers</label>
<input type="text" id="assistants" placeholder="@username, @username or N/A">

<label for="security">Security Department</label>
<input type="text" id="security" placeholder="@username, @username, @username">

<label for="medical">Medical Department</label>
<input type="text" id="medical" placeholder="@username or N/A">

<label for="classd">Class-D Personnel</label>
<input type="text" id="classd" placeholder="Number used">
</div>

<!-- Timeline -->
<div class="section">
<h2>Testing Timeline</h2>
<div id="timelineContainer"></div>
</div>

<button onclick="generateAll()">Generate Outputs</button>

<h2>Class-D Script</h2>
<div id="scriptOutput" class="output" style="display:none;"></div>

<h2>Full SCP Log</h2>
<button onclick="copyAllLog()">Copy All SCP Log</button>
<div id="logOutput" class="output" style="display:none;"></div>

<script>
function formatPersonnel(input){return input.trim()===""?"N/A":input.trim();}

function addTimelineStep(value="") {
  const container = document.getElementById("timelineContainer");
  const div = document.createElement("div");
  div.className = "timeline-step";

  const input = document.createElement("input");
  input.type = "text";
  input.value = value;
  input.placeholder = "Step description";

  input.onkeydown = function(e) {
    if (e.key === "Enter") {
      e.preventDefault();
      addTimelineStep();
      this.blur();
      const last = container.lastChild.querySelector("input");
      last.focus();
    } else if (e.key === "Backspace" && this.value === "") {
      e.preventDefault();
      if (container.children.length > 1) { // keep at least one step
        container.removeChild(div);
        if (container.lastChild) {
          container.lastChild.querySelector("input").focus();
        }
      }
    }
  };

  div.appendChild(input);
  container.appendChild(div);
  input.focus();
}

// Add first timeline step on load
addTimelineStep();

function copyLine(text){navigator.clipboard.writeText(text);}

function copyAllLog(){
  const log=document.getElementById("logOutput").textContent;
  navigator.clipboard.writeText(log);
}

function generateAll(){
  const host=formatPersonnel(document.getElementById("host").value);
  const scp=document.getElementById("scp").value||"###";
  const classification=document.getElementById("class").value||"Unclassified";
  const goal=document.getElementById("goal").value||"[goal not specified]";
  const materials=document.getElementById("materials").value||"N/A";
  const observations=document.getElementById("observations").value||"N/A";
  const analysis=document.getElementById("analysis").value||"N/A";
  const approved=formatPersonnel(document.getElementById("approved").value);

  const assistants=formatPersonnel(document.getElementById("assistants").value);
  const security=formatPersonnel(document.getElementById("security").value);
  const medical=formatPersonnel(document.getElementById("medical").value);
  const classd=formatPersonnel(document.getElementById("classd").value);

  // Get timeline steps
  const timelineContainer=document.getElementById("timelineContainer");
  let timelineSteps=[];
  timelineContainer.querySelectorAll("input").forEach((inp,i)=>{
    if(inp.value.trim()!==""){timelineSteps.push(`> ${i+1}. ${inp.value.trim()}`);}
  });
  if(timelineSteps.length===0) timelineSteps=["N/A"];

  // Today's date
  const today=new Date();
  const dateStr=today.toLocaleDateString('en-GB');

  // Class-D Script
  const scriptLines=[
    `Hello Class-Ds. We will be testing on SCP-${scp}. Please line up.`,
    `The goal of today’s test is to ${goal}.`,
    `Security personnel will ensure your safety, provided you comply with all instructions.`,
    `Any deviation or failure to cooperate will result in immediate termination.`,
    `Do you understand?`
  ];
  const scriptDiv=document.getElementById("scriptOutput");
  scriptDiv.innerHTML="";
  scriptLines.forEach(line=>{
    const div=document.createElement("div"); div.className="line";
    const span=document.createElement("span"); span.textContent=line;
    const button=document.createElement("button"); button.className="copy-btn"; button.textContent="Copy"; button.onclick=()=>copyLine(line);
    div.appendChild(span); div.appendChild(button); scriptDiv.appendChild(div);
  });
  scriptDiv.style.display="block";

  // SCP Log
  const logText=
`--
**SCP:** SCP-${scp}
**Classification:** ${classification}
**Date:** ${dateStr}

**Personnel:**
> **Lead Researcher:** ${host}
> **Assistant Researchers:** ${assistants}
> **Security Department:** ${security}
> **Medical Department:** ${medical}
> **Class-D Personnel:** ${classd}
▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬

**Testing Objective:**
> ${goal}

**Materials Used:**
> ${materials}

**Testing Timeline:**
${timelineSteps.join("\n")}

**Observations & Results:**
> ${observations}
▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬

**Analysis:**
> ${analysis}
▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬

**Approved By:** ${approved}
**Logged By:** ${host}
--`;
  const logDiv=document.getElementById("logOutput");
  logDiv.textContent=logText;
  logDiv.style.display="block";
}
</script>
</body>
</html>
